{"version":3,"sources":["existDB.js"],"names":["query","Resolve","Reject","db","then","result","error","testExist","exist","require","DB","username","password"],"mappings":";;;;;;;;;;;;;;;;;;;;0EAWO,iBAAyBA,KAAzB;AAAA;AAAA;AAAA;AAAA;AAECA,6BAFD,GAES,0BACG,kEADH,GAEG,sDAFH,GAGG,WAHH,GAIG,GAJH,GAKG,0DALH,GAK8DA,KAL9D,GAKoE,KALpE,GAMG,0CANH,GAOG,2BAPH,GAQG,6BARH,GASG,+FATH,GAUG,GAVH,GAWG,YAbZ;AAAA,yDAcI,sBAAa,UAAUC,OAAV,EAAkBC,MAAlB,EAAyB;;AAEzC,gCAAG;AACDC,mCAAGH,KAAH,CAASA,KAAT,EACKI,IADL,CACU,UAASC,MAAT,EAAiB;AACnB;AACAJ,4CAAQI,MAAR;AACD,iCAJP;AAMD,6BAPD,CAOE,OAAOC,KAAP,EAAa;AACZJ,uCAAQ,6CAA2CI,KAAnD;AACF;AAEF,yBAbI,CAdJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAeC,S;;;;;AA+BtB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AApEA;;;;AAFA,IAAIC,QAAQC,QAAQ,YAAR,CAAZ;;AAIA;AACA,IAAIN,KAAK,IAAIK,MAAME,EAAV,CAAa,uBAAb,EAAsC;AAC3CC,cAAU,kBAAUA,QADuB;AAE3CC,cAAU,kBAAUA;AAFuB,CAAtC,CAAT","file":"existDB.js","sourcesContent":["var exist = require('easy-exist');\n\nimport {EDB_LOGIN} from \"./config\"\n\n// connect\nvar db = new exist.DB('http://localhost:8080', {\n    username: EDB_LOGIN.username,\n    password: EDB_LOGIN.password,\n});\n\n\nexport async function testExist(query){\n\n    var query = 'xquery version \"3.0\";'\n                  +'declare default element namespace \"http://www.tei-c.org/ns/1.0\";'\n                  +'declare namespace tei=\"http://www.tei-c.org/ns/1.0\";'\n                  +'<entries>'\n                  +'{'\n                  +'for $hit in collection(\"/db/SRO\")//tei:div[ft:query(., \"'+query+'\")]'\n                  +'let $score as xs:float := ft:score($hit)'\n                  +' where $hit/@type=\"entry\"'\n                  +' order by $score descending'\n                  +' return <entry><docid>{data($hit/@xml:id)}</docid><score>{data($score)}</score>{$hit}</entry>'\n                  +'}'\n                  +'</entries>'\n    return new Promise( function (Resolve,Reject){\n\n        try{\n          db.query(query)\n              .then(function(result) {\n                  //console.log('xQuery result:', result);\n                  Resolve(result)\n                })\n\n        } catch (error){\n           Reject (\"Something failed in the ExistDB Module: \"+error)\n        }\n\n      });\n\n  }\n\n// USAGE EXAMPLE OF THE EASY-EXIST MODULE\n\n// PUT a document\n// db.put('/my-collection/my-document', body)\n//\n//     // Get the body of a document\n//     .then(function() {\n//         return db.get('/my-collection/my-document');\n//     })\n//     .then(function(doc) {\n//         console.log('Document Body:', doc);\n//     })\n//\n//     // Execute xQuery\n//     .then(function() {\n//         return db.query('collection(\"my-collection\")/message/body');\n//     })\n//     .then(function(result) {\n//         console.log('xQuery result:', result);\n//     })\n//\n//     // Delete document\n//     .then(function() {\n//         return db.delete('/my-collection/my-document');\n//     })\n//     .then(function() {\n//         console.log('Document Deleted');\n//     });\n//\n"]}