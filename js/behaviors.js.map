{"version":3,"sources":["js/behaviors.js"],"names":["ceteicean","shadow","createShadowRoot","img","Image","src","rw","getAttribute","hasAttribute","width","replace","height","appendChild","innerHTML","elt","addEventListener","event","window","location","content"],"mappings":";;;;;kBAAe;AACb,cAAY;AACV;AACA;AACA,WAAO,CAAC,qCAAD,CAHG;AAIV;AACA,WAAO,CAAC,yBAAD,EAA2B,MAA3B,CALG;AAMV,eAAW,mBAAW;AACpB,UAAIA,YAAY,IAAhB;AACA,aAAO,YAAW;AAChB,YAAIC,SAAS,KAAKC,gBAAL,EAAb;AACA,YAAIC,MAAM,IAAIC,KAAJ,EAAV;AACAD,YAAIE,GAAJ,GAAUL,UAAUM,EAAV,CAAa,KAAKC,YAAL,CAAkB,KAAlB,CAAb,CAAV;AACA,YAAI,KAAKC,YAAL,CAAkB,OAAlB,CAAJ,EAAgC;AAC9BL,cAAIM,KAAJ,GAAY,KAAKF,YAAL,CAAkB,OAAlB,EAA2BG,OAA3B,CAAmC,UAAnC,EAA+C,EAA/C,CAAZ;AACD;AACD,YAAI,KAAKF,YAAL,CAAkB,QAAlB,CAAJ,EAAiC;AAC/BL,cAAIQ,MAAJ,GAAa,KAAKJ,YAAL,CAAkB,QAAlB,EAA4BG,OAA5B,CAAoC,UAApC,EAAgD,EAAhD,CAAb;AACD;AACDT,eAAOW,WAAP,CAAmBT,GAAnB;AACD,OAXD;AAYD,KApBS;AAqBV,aAAS,iBAAW;AAClB,aAAO,YAAW;AAChB,YAAIF,SAAS,KAAKC,gBAAL,EAAb;AACAD,eAAOY,SAAP,GAAmB,UAAU,KAAKA,SAAL,CAAeH,OAAf,CAAuB,IAAvB,EAA6B,MAA7B,CAAV,GAAiD,QAApE;AACD,OAHD;AAID;AA1BS,GADC;AA6Bb,eAAa;AACX,WAAO,aAASI,GAAT,EAAc;AACnB,UAAId,YAAY,IAAhB;AACAc,UAAIC,gBAAJ,CAAqB,OAArB,EAA8B,UAASC,KAAT,EAAgB;AAC5CC,eAAOC,QAAP,GAAkBlB,UAAUM,EAAV,CAAaQ,IAAIP,YAAJ,CAAiB,QAAjB,CAAb,CAAlB;AACD,OAFD;AAGD,KANU;AAOX,eAAW,iBAASO,GAAT,EAAc;AACvB,UAAId,YAAY,IAAhB;AACA,UAAImB,UAAU,IAAIf,KAAJ,EAAd;AACAe,cAAQd,GAAR,GAAcL,UAAUM,EAAV,CAAa,KAAKC,YAAL,CAAkB,KAAlB,CAAb,CAAd;AACA,UAAIO,IAAIN,YAAJ,CAAiB,OAAjB,CAAJ,EAA+B;AAC7BW,gBAAQV,KAAR,GAAgBK,IAAIP,YAAJ,CAAiB,OAAjB,EAA0BG,OAA1B,CAAkC,UAAlC,EAA8C,EAA9C,CAAhB;AACD;AACD,UAAII,IAAIN,YAAJ,CAAiB,QAAjB,CAAJ,EAAgC;AAC9BW,gBAAQR,MAAR,GAAiBG,IAAIP,YAAJ,CAAiB,QAAjB,EAA2BG,OAA3B,CAAmC,UAAnC,EAA+C,EAA/C,CAAjB;AACD;AACDI,UAAIF,WAAJ,CAAgBO,OAAhB;AACD,KAlBU;AAmBX,aAAS,eAASL,GAAT,EAAc;AACrB,UAAIK,UAAUL,IAAID,SAAlB;AACAC,UAAID,SAAJ,GAAgB,kCAAkCC,IAAID,SAAtC,GAAkD,SAAlE;AACAC,UAAID,SAAJ,IAAiB,UAAUM,QAAQT,OAAR,CAAgB,IAAhB,EAAsB,MAAtB,CAAV,GAA0C,QAA3D;AACD;AAvBU;AA7BA,C","file":"js/behaviors.js","sourcesContent":["export default {\n  \"handlers\": {\n    // inserts a link inside <ptr> using the @target; the link in the\n    // @href is piped through the rw (rewrite) function before insertion\n    \"ptr\": [\"<a href=\\\"$rw@target\\\">$@target</a>\"],\n    // wraps the content of the <ref> in an HTML link\n    \"ref\": [\"<a href=\\\"$rw@target\\\">\",\"</a>\"],\n    \"graphic\": function() {\n      let ceteicean = this;\n      return function() {\n        let shadow = this.createShadowRoot();\n        let img = new Image();\n        img.src = ceteicean.rw(this.getAttribute(\"url\"));\n        if (this.hasAttribute(\"width\")) {\n          img.width = this.getAttribute(\"width\").replace(/[^.0-9]/g, \"\");\n        }\n        if (this.hasAttribute(\"height\")) {\n          img.height = this.getAttribute(\"height\").replace(/[^.0-9]/g, \"\");\n        }\n        shadow.appendChild(img);\n      }\n    },\n    \"egXML\": function() {\n      return function() {\n        let shadow = this.createShadowRoot();\n        shadow.innerHTML = \"<pre>\" + this.innerHTML.replace(/</g, \"&lt;\") + \"</pre>\";\n      }\n    }\n  },\n  \"fallbacks\": {\n    \"ref\": function(elt) {\n      let ceteicean = this;\n      elt.addEventListener(\"click\", function(event) {\n        window.location = ceteicean.rw(elt.getAttribute(\"target\"));\n      });\n    },\n    \"graphic\": function(elt) {\n      let ceteicean = this;\n      let content = new Image();\n      content.src = ceteicean.rw(this.getAttribute(\"url\"));\n      if (elt.hasAttribute(\"width\")) {\n        content.width = elt.getAttribute(\"width\").replace(/[^.0-9]/g, \"\");\n      }\n      if (elt.hasAttribute(\"height\")) {\n        content.height = elt.getAttribute(\"height\").replace(/[^.0-9]/g, \"\");\n      }\n      elt.appendChild(content);\n    },\n    \"egXML\": function(elt) {\n      let content = elt.innerHTML;\n      elt.innerHTML = \"<span style=\\\"display:none\\\">\" + elt.innerHTML + \"</span>\";\n      elt.innerHTML += \"<pre>\" + content.replace(/</g, \"&lt;\") + \"</pre>\";\n    }\n  }\n}\n"],"sourceRoot":"/source/"}